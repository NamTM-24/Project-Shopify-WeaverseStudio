var __defProp=Object.defineProperty,__getOwnPropDesc=Object.getOwnPropertyDescriptor,__getOwnPropNames=Object.getOwnPropertyNames,__hasOwnProp=Object.prototype.hasOwnProperty,__markAsModule=target=>__defProp(target,"__esModule",{value:!0}),__export=(target,all)=>{for(var name in all)__defProp(target,name,{get:all[name],enumerable:!0})},__reExport=(target,module2,copyDefault,desc)=>{if(module2&&typeof module2=="object"||typeof module2=="function")for(let key of __getOwnPropNames(module2))!__hasOwnProp.call(target,key)&&(copyDefault||key!=="default")&&__defProp(target,key,{get:()=>module2[key],enumerable:!(desc=__getOwnPropDesc(module2,key))||desc.enumerable});return target},__toCommonJS=(cache=>(module2,temp)=>cache&&cache.get(module2)||(temp=__reExport(__markAsModule({}),module2,1),cache&&cache.set(module2,temp),temp))(typeof WeakMap<"u"?new WeakMap:0),lib_exports={};__export(lib_exports,{JSEncrypt:()=>JSEncrypt,default:()=>lib_default});var BI_RM="0123456789abcdefghijklmnopqrstuvwxyz";function int2char(n){return BI_RM.charAt(n)}function op_and(x,y){return x&y}function op_or(x,y){return x|y}function op_xor(x,y){return x^y}function op_andnot(x,y){return x&~y}function lbit(x){if(x==0)return-1;var r=0;return(x&65535)==0&&(x>>=16,r+=16),(x&255)==0&&(x>>=8,r+=8),(x&15)==0&&(x>>=4,r+=4),(x&3)==0&&(x>>=2,r+=2),(x&1)==0&&++r,r}function cbit(x){for(var r=0;x!=0;)x&=x-1,++r;return r}var b64map="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",b64pad="=";function hex2b64(h){var i,c,ret="";for(i=0;i+3<=h.length;i+=3)c=parseInt(h.substring(i,i+3),16),ret+=b64map.charAt(c>>6)+b64map.charAt(c&63);for(i+1==h.length?(c=parseInt(h.substring(i,i+1),16),ret+=b64map.charAt(c<<2)):i+2==h.length&&(c=parseInt(h.substring(i,i+2),16),ret+=b64map.charAt(c>>2)+b64map.charAt((c&3)<<4));(ret.length&3)>0;)ret+=b64pad;return ret}function b64tohex(s){var ret="",i,k=0,slop=0;for(i=0;i<s.length&&s.charAt(i)!=b64pad;++i){var v=b64map.indexOf(s.charAt(i));v<0||(k==0?(ret+=int2char(v>>2),slop=v&3,k=1):k==1?(ret+=int2char(slop<<2|v>>4),slop=v&15,k=2):k==2?(ret+=int2char(slop),ret+=int2char(v>>2),slop=v&3,k=3):(ret+=int2char(slop<<2|v>>4),ret+=int2char(v&15),k=0))}return k==1&&(ret+=int2char(slop<<2)),ret}var decoder,Hex={decode:function(a){var i;if(decoder===void 0){var hex="0123456789ABCDEF",ignore=` \f
\r	\xA0\u2028\u2029`;for(decoder={},i=0;i<16;++i)decoder[hex.charAt(i)]=i;for(hex=hex.toLowerCase(),i=10;i<16;++i)decoder[hex.charAt(i)]=i;for(i=0;i<ignore.length;++i)decoder[ignore.charAt(i)]=-1}var out=[],bits=0,char_count=0;for(i=0;i<a.length;++i){var c=a.charAt(i);if(c=="=")break;if(c=decoder[c],c!=-1){if(c===void 0)throw new Error("Illegal character at offset "+i);bits|=c,++char_count>=2?(out[out.length]=bits,bits=0,char_count=0):bits<<=4}}if(char_count)throw new Error("Hex encoding incomplete: 4 bits missing");return out}},decoder2,Base64={decode:function(a){var i;if(decoder2===void 0){var b64="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",ignore=`= \f
\r	\xA0\u2028\u2029`;for(decoder2=Object.create(null),i=0;i<64;++i)decoder2[b64.charAt(i)]=i;for(decoder2["-"]=62,decoder2._=63,i=0;i<ignore.length;++i)decoder2[ignore.charAt(i)]=-1}var out=[],bits=0,char_count=0;for(i=0;i<a.length;++i){var c=a.charAt(i);if(c=="=")break;if(c=decoder2[c],c!=-1){if(c===void 0)throw new Error("Illegal character at offset "+i);bits|=c,++char_count>=4?(out[out.length]=bits>>16,out[out.length]=bits>>8&255,out[out.length]=bits&255,bits=0,char_count=0):bits<<=6}}switch(char_count){case 1:throw new Error("Base64 encoding incomplete: at least 2 bits missing");case 2:out[out.length]=bits>>10;break;case 3:out[out.length]=bits>>16,out[out.length]=bits>>8&255;break}return out},re:/-----BEGIN [^-]+-----([A-Za-z0-9+\/=\s]+)-----END [^-]+-----|begin-base64[^\n]+\n([A-Za-z0-9+\/=\s]+)====/,unarmor:function(a){var m=Base64.re.exec(a);if(m)if(m[1])a=m[1];else if(m[2])a=m[2];else throw new Error("RegExp out of sync");return Base64.decode(a)}},max=1e13,Int10=function(){function Int102(value){this.buf=[+value||0]}return Int102.prototype.mulAdd=function(m,c){var b=this.buf,l=b.length,i,t2;for(i=0;i<l;++i)t2=b[i]*m+c,t2<max?c=0:(c=0|t2/max,t2-=c*max),b[i]=t2;c>0&&(b[i]=c)},Int102.prototype.sub=function(c){var b=this.buf,l=b.length,i,t2;for(i=0;i<l;++i)t2=b[i]-c,t2<0?(t2+=max,c=1):c=0,b[i]=t2;for(;b[b.length-1]===0;)b.pop()},Int102.prototype.toString=function(base){if((base||10)!=10)throw new Error("only base 10 is supported");for(var b=this.buf,s=b[b.length-1].toString(),i=b.length-2;i>=0;--i)s+=(max+b[i]).toString().substring(1);return s},Int102.prototype.valueOf=function(){for(var b=this.buf,v=0,i=b.length-1;i>=0;--i)v=v*max+b[i];return v},Int102.prototype.simplify=function(){var b=this.buf;return b.length==1?b[0]:this},Int102}(),ellipsis="\u2026",reTimeS=/^(\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/,reTimeL=/^(\d\d\d\d)(0[1-9]|1[0-2])(0[1-9]|[12]\d|3[01])([01]\d|2[0-3])(?:([0-5]\d)(?:([0-5]\d)(?:[.,](\d{1,3}))?)?)?(Z|[-+](?:[0]\d|1[0-2])([0-5]\d)?)?$/;function stringCut(str,len){return str.length>len&&(str=str.substring(0,len)+ellipsis),str}var Stream=function(){function Stream2(enc,pos){this.hexDigits="0123456789ABCDEF",enc instanceof Stream2?(this.enc=enc.enc,this.pos=enc.pos):(this.enc=enc,this.pos=pos)}return Stream2.prototype.get=function(pos){if(pos===void 0&&(pos=this.pos++),pos>=this.enc.length)throw new Error("Requesting byte offset ".concat(pos," on a stream of length ").concat(this.enc.length));return typeof this.enc=="string"?this.enc.charCodeAt(pos):this.enc[pos]},Stream2.prototype.hexByte=function(b){return this.hexDigits.charAt(b>>4&15)+this.hexDigits.charAt(b&15)},Stream2.prototype.hexDump=function(start,end,raw){for(var s="",i=start;i<end;++i)if(s+=this.hexByte(this.get(i)),raw!==!0)switch(i&15){case 7:s+="  ";break;case 15:s+=`
`;break;default:s+=" "}return s},Stream2.prototype.isASCII=function(start,end){for(var i=start;i<end;++i){var c=this.get(i);if(c<32||c>176)return!1}return!0},Stream2.prototype.parseStringISO=function(start,end){for(var s="",i=start;i<end;++i)s+=String.fromCharCode(this.get(i));return s},Stream2.prototype.parseStringUTF=function(start,end){for(var s="",i=start;i<end;){var c=this.get(i++);c<128?s+=String.fromCharCode(c):c>191&&c<224?s+=String.fromCharCode((c&31)<<6|this.get(i++)&63):s+=String.fromCharCode((c&15)<<12|(this.get(i++)&63)<<6|this.get(i++)&63)}return s},Stream2.prototype.parseStringBMP=function(start,end){for(var str="",hi,lo,i=start;i<end;)hi=this.get(i++),lo=this.get(i++),str+=String.fromCharCode(hi<<8|lo);return str},Stream2.prototype.parseTime=function(start,end,shortYear){var s=this.parseStringISO(start,end),m=(shortYear?reTimeS:reTimeL).exec(s);return m?(shortYear&&(m[1]=+m[1],m[1]+=+m[1]<70?2e3:1900),s=m[1]+"-"+m[2]+"-"+m[3]+" "+m[4],m[5]&&(s+=":"+m[5],m[6]&&(s+=":"+m[6],m[7]&&(s+="."+m[7]))),m[8]&&(s+=" UTC",m[8]!="Z"&&(s+=m[8],m[9]&&(s+=":"+m[9]))),s):"Unrecognized time: "+s},Stream2.prototype.parseInteger=function(start,end){for(var v=this.get(start),neg=v>127,pad=neg?255:0,len,s="";v==pad&&++start<end;)v=this.get(start);if(len=end-start,len===0)return neg?-1:0;if(len>4){for(s=v,len<<=3;((+s^pad)&128)==0;)s=+s<<1,--len;s="("+len+` bit)
`}neg&&(v=v-256);for(var n=new Int10(v),i=start+1;i<end;++i)n.mulAdd(256,this.get(i));return s+n.toString()},Stream2.prototype.parseBitString=function(start,end,maxLength){for(var unusedBit=this.get(start),lenBit=(end-start-1<<3)-unusedBit,intro="("+lenBit+` bit)
`,s="",i=start+1;i<end;++i){for(var b=this.get(i),skip=i==end-1?unusedBit:0,j=7;j>=skip;--j)s+=b>>j&1?"1":"0";if(s.length>maxLength)return intro+stringCut(s,maxLength)}return intro+s},Stream2.prototype.parseOctetString=function(start,end,maxLength){if(this.isASCII(start,end))return stringCut(this.parseStringISO(start,end),maxLength);var len=end-start,s="("+len+` byte)
`;maxLength/=2,len>maxLength&&(end=start+maxLength);for(var i=start;i<end;++i)s+=this.hexByte(this.get(i));return len>maxLength&&(s+=ellipsis),s},Stream2.prototype.parseOID=function(start,end,maxLength){for(var s="",n=new Int10,bits=0,i=start;i<end;++i){var v=this.get(i);if(n.mulAdd(128,v&127),bits+=7,!(v&128)){if(s==="")if(n=n.simplify(),n instanceof Int10)n.sub(80),s="2."+n.toString();else{var m=n<80?n<40?0:1:2;s=m+"."+(n-m*40)}else s+="."+n.toString();if(s.length>maxLength)return stringCut(s,maxLength);n=new Int10,bits=0}}return bits>0&&(s+=".incomplete"),s},Stream2}(),ASN1=function(){function ASN12(stream,header,length,tag,sub){if(!(tag instanceof ASN1Tag))throw new Error("Invalid tag value.");this.stream=stream,this.header=header,this.length=length,this.tag=tag,this.sub=sub}return ASN12.prototype.typeName=function(){switch(this.tag.tagClass){case 0:switch(this.tag.tagNumber){case 0:return"EOC";case 1:return"BOOLEAN";case 2:return"INTEGER";case 3:return"BIT_STRING";case 4:return"OCTET_STRING";case 5:return"NULL";case 6:return"OBJECT_IDENTIFIER";case 7:return"ObjectDescriptor";case 8:return"EXTERNAL";case 9:return"REAL";case 10:return"ENUMERATED";case 11:return"EMBEDDED_PDV";case 12:return"UTF8String";case 16:return"SEQUENCE";case 17:return"SET";case 18:return"NumericString";case 19:return"PrintableString";case 20:return"TeletexString";case 21:return"VideotexString";case 22:return"IA5String";case 23:return"UTCTime";case 24:return"GeneralizedTime";case 25:return"GraphicString";case 26:return"VisibleString";case 27:return"GeneralString";case 28:return"UniversalString";case 30:return"BMPString"}return"Universal_"+this.tag.tagNumber.toString();case 1:return"Application_"+this.tag.tagNumber.toString();case 2:return"["+this.tag.tagNumber.toString()+"]";case 3:return"Private_"+this.tag.tagNumber.toString()}},ASN12.prototype.content=function(maxLength){if(this.tag===void 0)return null;maxLength===void 0&&(maxLength=1/0);var content=this.posContent(),len=Math.abs(this.length);if(!this.tag.isUniversal())return this.sub!==null?"("+this.sub.length+" elem)":this.stream.parseOctetString(content,content+len,maxLength);switch(this.tag.tagNumber){case 1:return this.stream.get(content)===0?"false":"true";case 2:return this.stream.parseInteger(content,content+len);case 3:return this.sub?"("+this.sub.length+" elem)":this.stream.parseBitString(content,content+len,maxLength);case 4:return this.sub?"("+this.sub.length+" elem)":this.stream.parseOctetString(content,content+len,maxLength);case 6:return this.stream.parseOID(content,content+len,maxLength);case 16:case 17:return this.sub!==null?"("+this.sub.length+" elem)":"(no elem)";case 12:return stringCut(this.stream.parseStringUTF(content,content+len),maxLength);case 18:case 19:case 20:case 21:case 22:case 26:return stringCut(this.stream.parseStringISO(content,content+len),maxLength);case 30:return stringCut(this.stream.parseStringBMP(content,content+len),maxLength);case 23:case 24:return this.stream.parseTime(content,content+len,this.tag.tagNumber==23)}return null},ASN12.prototype.toString=function(){return this.typeName()+"@"+this.stream.pos+"[header:"+this.header+",length:"+this.length+",sub:"+(this.sub===null?"null":this.sub.length)+"]"},ASN12.prototype.toPrettyString=function(indent){indent===void 0&&(indent="");var s=indent+this.typeName()+" @"+this.stream.pos;if(this.length>=0&&(s+="+"),s+=this.length,this.tag.tagConstructed?s+=" (constructed)":this.tag.isUniversal()&&(this.tag.tagNumber==3||this.tag.tagNumber==4)&&this.sub!==null&&(s+=" (encapsulates)"),s+=`
`,this.sub!==null){indent+="  ";for(var i=0,max2=this.sub.length;i<max2;++i)s+=this.sub[i].toPrettyString(indent)}return s},ASN12.prototype.posStart=function(){return this.stream.pos},ASN12.prototype.posContent=function(){return this.stream.pos+this.header},ASN12.prototype.posEnd=function(){return this.stream.pos+this.header+Math.abs(this.length)},ASN12.prototype.toHexString=function(){return this.stream.hexDump(this.posStart(),this.posEnd(),!0)},ASN12.decodeLength=function(stream){var buf=stream.get(),len=buf&127;if(len==buf)return len;if(len>6)throw new Error("Length over 48 bits not supported at position "+(stream.pos-1));if(len===0)return null;buf=0;for(var i=0;i<len;++i)buf=buf*256+stream.get();return buf},ASN12.prototype.getHexStringValue=function(){var hexString=this.toHexString(),offset=this.header*2,length=this.length*2;return hexString.substr(offset,length)},ASN12.decode=function(str){var stream;str instanceof Stream?stream=str:stream=new Stream(str,0);var streamStart=new Stream(stream),tag=new ASN1Tag(stream),len=ASN12.decodeLength(stream),start=stream.pos,header=start-streamStart.pos,sub=null,getSub=function(){var ret=[];if(len!==null){for(var end=start+len;stream.pos<end;)ret[ret.length]=ASN12.decode(stream);if(stream.pos!=end)throw new Error("Content size is not correct for container starting at offset "+start)}else try{for(;;){var s=ASN12.decode(stream);if(s.tag.isEOC())break;ret[ret.length]=s}len=start-stream.pos}catch(e){throw new Error("Exception while decoding undefined length content: "+e)}return ret};if(tag.tagConstructed)sub=getSub();else if(tag.isUniversal()&&(tag.tagNumber==3||tag.tagNumber==4))try{if(tag.tagNumber==3&&stream.get()!=0)throw new Error("BIT STRINGs with unused bits cannot encapsulate.");sub=getSub();for(var i=0;i<sub.length;++i)if(sub[i].tag.isEOC())throw new Error("EOC is not supposed to be actual content.")}catch{sub=null}if(sub===null){if(len===null)throw new Error("We can't skip over an invalid tag with undefined length at offset "+start);stream.pos=start+Math.abs(len)}return new ASN12(streamStart,header,len,tag,sub)},ASN12}(),ASN1Tag=function(){function ASN1Tag2(stream){var buf=stream.get();if(this.tagClass=buf>>6,this.tagConstructed=(buf&32)!==0,this.tagNumber=buf&31,this.tagNumber==31){var n=new Int10;do buf=stream.get(),n.mulAdd(128,buf&127);while(buf&128);this.tagNumber=n.simplify()}}return ASN1Tag2.prototype.isUniversal=function(){return this.tagClass===0},ASN1Tag2.prototype.isEOC=function(){return this.tagClass===0&&this.tagNumber===0},ASN1Tag2}(),dbits,canary=0xdeadbeefcafe,j_lm=(canary&16777215)==15715070,lowprimes=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],lplim=(1<<26)/lowprimes[lowprimes.length-1],BigInteger=function(){function BigInteger2(a,b,c){a!=null&&(typeof a=="number"?this.fromNumber(a,b,c):b==null&&typeof a!="string"?this.fromString(a,256):this.fromString(a,b))}return BigInteger2.prototype.toString=function(b){if(this.s<0)return"-"+this.negate().toString(b);var k;if(b==16)k=4;else if(b==8)k=3;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else return this.toRadix(b);var km=(1<<k)-1,d,m=!1,r="",i=this.t,p=this.DB-i*this.DB%k;if(i-- >0)for(p<this.DB&&(d=this[i]>>p)>0&&(m=!0,r=int2char(d));i>=0;)p<k?(d=(this[i]&(1<<p)-1)<<k-p,d|=this[--i]>>(p+=this.DB-k)):(d=this[i]>>(p-=k)&km,p<=0&&(p+=this.DB,--i)),d>0&&(m=!0),m&&(r+=int2char(d));return m?r:"0"},BigInteger2.prototype.negate=function(){var r=nbi();return BigInteger2.ZERO.subTo(this,r),r},BigInteger2.prototype.abs=function(){return this.s<0?this.negate():this},BigInteger2.prototype.compareTo=function(a){var r=this.s-a.s;if(r!=0)return r;var i=this.t;if(r=i-a.t,r!=0)return this.s<0?-r:r;for(;--i>=0;)if((r=this[i]-a[i])!=0)return r;return 0},BigInteger2.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+nbits(this[this.t-1]^this.s&this.DM)},BigInteger2.prototype.mod=function(a){var r=nbi();return this.abs().divRemTo(a,null,r),this.s<0&&r.compareTo(BigInteger2.ZERO)>0&&a.subTo(r,r),r},BigInteger2.prototype.modPowInt=function(e,m){var z2;return e<256||m.isEven()?z2=new Classic(m):z2=new Montgomery(m),this.exp(e,z2)},BigInteger2.prototype.clone=function(){var r=nbi();return this.copyTo(r),r},BigInteger2.prototype.intValue=function(){if(this.s<0){if(this.t==1)return this[0]-this.DV;if(this.t==0)return-1}else{if(this.t==1)return this[0];if(this.t==0)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},BigInteger2.prototype.byteValue=function(){return this.t==0?this.s:this[0]<<24>>24},BigInteger2.prototype.shortValue=function(){return this.t==0?this.s:this[0]<<16>>16},BigInteger2.prototype.signum=function(){return this.s<0?-1:this.t<=0||this.t==1&&this[0]<=0?0:1},BigInteger2.prototype.toByteArray=function(){var i=this.t,r=[];r[0]=this.s;var p=this.DB-i*this.DB%8,d,k=0;if(i-- >0)for(p<this.DB&&(d=this[i]>>p)!=(this.s&this.DM)>>p&&(r[k++]=d|this.s<<this.DB-p);i>=0;)p<8?(d=(this[i]&(1<<p)-1)<<8-p,d|=this[--i]>>(p+=this.DB-8)):(d=this[i]>>(p-=8)&255,p<=0&&(p+=this.DB,--i)),(d&128)!=0&&(d|=-256),k==0&&(this.s&128)!=(d&128)&&++k,(k>0||d!=this.s)&&(r[k++]=d);return r},BigInteger2.prototype.equals=function(a){return this.compareTo(a)==0},BigInteger2.prototype.min=function(a){return this.compareTo(a)<0?this:a},BigInteger2.prototype.max=function(a){return this.compareTo(a)>0?this:a},BigInteger2.prototype.and=function(a){var r=nbi();return this.bitwiseTo(a,op_and,r),r},BigInteger2.prototype.or=function(a){var r=nbi();return this.bitwiseTo(a,op_or,r),r},BigInteger2.prototype.xor=function(a){var r=nbi();return this.bitwiseTo(a,op_xor,r),r},BigInteger2.prototype.andNot=function(a){var r=nbi();return this.bitwiseTo(a,op_andnot,r),r},BigInteger2.prototype.not=function(){for(var r=nbi(),i=0;i<this.t;++i)r[i]=this.DM&~this[i];return r.t=this.t,r.s=~this.s,r},BigInteger2.prototype.shiftLeft=function(n){var r=nbi();return n<0?this.rShiftTo(-n,r):this.lShiftTo(n,r),r},BigInteger2.prototype.shiftRight=function(n){var r=nbi();return n<0?this.lShiftTo(-n,r):this.rShiftTo(n,r),r},BigInteger2.prototype.getLowestSetBit=function(){for(var i=0;i<this.t;++i)if(this[i]!=0)return i*this.DB+lbit(this[i]);return this.s<0?this.t*this.DB:-1},BigInteger2.prototype.bitCount=function(){for(var r=0,x=this.s&this.DM,i=0;i<this.t;++i)r+=cbit(this[i]^x);return r},BigInteger2.prototype.testBit=function(n){var j=Math.floor(n/this.DB);return j>=this.t?this.s!=0:(this[j]&1<<n%this.DB)!=0},BigInteger2.prototype.setBit=function(n){return this.changeBit(n,op_or)},BigInteger2.prototype.clearBit=function(n){return this.changeBit(n,op_andnot)},BigInteger2.prototype.flipBit=function(n){return this.changeBit(n,op_xor)},BigInteger2.prototype.add=function(a){var r=nbi();return this.addTo(a,r),r},BigInteger2.prototype.subtract=function(a){var r=nbi();return this.subTo(a,r),r},BigInteger2.prototype.multiply=function(a){var r=nbi();return this.multiplyTo(a,r),r},BigInteger2.prototype.divide=function(a){var r=nbi();return this.divRemTo(a,r,null),r},BigInteger2.prototype.remainder=function(a){var r=nbi();return this.divRemTo(a,null,r),r},BigInteger2.prototype.divideAndRemainder=function(a){var q=nbi(),r=nbi();return this.divRemTo(a,q,r),[q,r]},BigInteger2.prototype.modPow=function(e,m){var i=e.bitLength(),k,r=nbv(1),z2;if(i<=0)return r;i<18?k=1:i<48?k=3:i<144?k=4:i<768?k=5:k=6,i<8?z2=new Classic(m):m.isEven()?z2=new Barrett(m):z2=new Montgomery(m);var g=[],n=3,k1=k-1,km=(1<<k)-1;if(g[1]=z2.convert(this),k>1){var g2=nbi();for(z2.sqrTo(g[1],g2);n<=km;)g[n]=nbi(),z2.mulTo(g2,g[n-2],g[n]),n+=2}var j=e.t-1,w,is1=!0,r2=nbi(),t2;for(i=nbits(e[j])-1;j>=0;){for(i>=k1?w=e[j]>>i-k1&km:(w=(e[j]&(1<<i+1)-1)<<k1-i,j>0&&(w|=e[j-1]>>this.DB+i-k1)),n=k;(w&1)==0;)w>>=1,--n;if((i-=n)<0&&(i+=this.DB,--j),is1)g[w].copyTo(r),is1=!1;else{for(;n>1;)z2.sqrTo(r,r2),z2.sqrTo(r2,r),n-=2;n>0?z2.sqrTo(r,r2):(t2=r,r=r2,r2=t2),z2.mulTo(r2,g[w],r)}for(;j>=0&&(e[j]&1<<i)==0;)z2.sqrTo(r,r2),t2=r,r=r2,r2=t2,--i<0&&(i=this.DB-1,--j)}return z2.revert(r)},BigInteger2.prototype.modInverse=function(m){var ac=m.isEven();if(this.isEven()&&ac||m.signum()==0)return BigInteger2.ZERO;for(var u=m.clone(),v=this.clone(),a=nbv(1),b=nbv(0),c=nbv(0),d=nbv(1);u.signum()!=0;){for(;u.isEven();)u.rShiftTo(1,u),ac?((!a.isEven()||!b.isEven())&&(a.addTo(this,a),b.subTo(m,b)),a.rShiftTo(1,a)):b.isEven()||b.subTo(m,b),b.rShiftTo(1,b);for(;v.isEven();)v.rShiftTo(1,v),ac?((!c.isEven()||!d.isEven())&&(c.addTo(this,c),d.subTo(m,d)),c.rShiftTo(1,c)):d.isEven()||d.subTo(m,d),d.rShiftTo(1,d);u.compareTo(v)>=0?(u.subTo(v,u),ac&&a.subTo(c,a),b.subTo(d,b)):(v.subTo(u,v),ac&&c.subTo(a,c),d.subTo(b,d))}if(v.compareTo(BigInteger2.ONE)!=0)return BigInteger2.ZERO;if(d.compareTo(m)>=0)return d.subtract(m);if(d.signum()<0)d.addTo(m,d);else return d;return d.signum()<0?d.add(m):d},BigInteger2.prototype.pow=function(e){return this.exp(e,new NullExp)},BigInteger2.prototype.gcd=function(a){var x=this.s<0?this.negate():this.clone(),y=a.s<0?a.negate():a.clone();if(x.compareTo(y)<0){var t2=x;x=y,y=t2}var i=x.getLowestSetBit(),g=y.getLowestSetBit();if(g<0)return x;for(i<g&&(g=i),g>0&&(x.rShiftTo(g,x),y.rShiftTo(g,y));x.signum()>0;)(i=x.getLowestSetBit())>0&&x.rShiftTo(i,x),(i=y.getLowestSetBit())>0&&y.rShiftTo(i,y),x.compareTo(y)>=0?(x.subTo(y,x),x.rShiftTo(1,x)):(y.subTo(x,y),y.rShiftTo(1,y));return g>0&&y.lShiftTo(g,y),y},BigInteger2.prototype.isProbablePrime=function(t2){var i,x=this.abs();if(x.t==1&&x[0]<=lowprimes[lowprimes.length-1]){for(i=0;i<lowprimes.length;++i)if(x[0]==lowprimes[i])return!0;return!1}if(x.isEven())return!1;for(i=1;i<lowprimes.length;){for(var m=lowprimes[i],j=i+1;j<lowprimes.length&&m<lplim;)m*=lowprimes[j++];for(m=x.modInt(m);i<j;)if(m%lowprimes[i++]==0)return!1}return x.millerRabin(t2)},BigInteger2.prototype.copyTo=function(r){for(var i=this.t-1;i>=0;--i)r[i]=this[i];r.t=this.t,r.s=this.s},BigInteger2.prototype.fromInt=function(x){this.t=1,this.s=x<0?-1:0,x>0?this[0]=x:x<-1?this[0]=x+this.DV:this.t=0},BigInteger2.prototype.fromString=function(s,b){var k;if(b==16)k=4;else if(b==8)k=3;else if(b==256)k=8;else if(b==2)k=1;else if(b==32)k=5;else if(b==4)k=2;else{this.fromRadix(s,b);return}this.t=0,this.s=0;for(var i=s.length,mi=!1,sh=0;--i>=0;){var x=k==8?+s[i]&255:intAt(s,i);if(x<0){s.charAt(i)=="-"&&(mi=!0);continue}mi=!1,sh==0?this[this.t++]=x:sh+k>this.DB?(this[this.t-1]|=(x&(1<<this.DB-sh)-1)<<sh,this[this.t++]=x>>this.DB-sh):this[this.t-1]|=x<<sh,sh+=k,sh>=this.DB&&(sh-=this.DB)}k==8&&(+s[0]&128)!=0&&(this.s=-1,sh>0&&(this[this.t-1]|=(1<<this.DB-sh)-1<<sh)),this.clamp(),mi&&BigInteger2.ZERO.subTo(this,this)},BigInteger2.prototype.clamp=function(){for(var c=this.s&this.DM;this.t>0&&this[this.t-1]==c;)--this.t},BigInteger2.prototype.dlShiftTo=function(n,r){var i;for(i=this.t-1;i>=0;--i)r[i+n]=this[i];for(i=n-1;i>=0;--i)r[i]=0;r.t=this.t+n,r.s=this.s},BigInteger2.prototype.drShiftTo=function(n,r){for(var i=n;i<this.t;++i)r[i-n]=this[i];r.t=Math.max(this.t-n,0),r.s=this.s},BigInteger2.prototype.lShiftTo=function(n,r){for(var bs=n%this.DB,cbs=this.DB-bs,bm=(1<<cbs)-1,ds=Math.floor(n/this.DB),c=this.s<<bs&this.DM,i=this.t-1;i>=0;--i)r[i+ds+1]=this[i]>>cbs|c,c=(this[i]&bm)<<bs;for(i=ds-1;i>=0;--i)r[i]=0;r[ds]=c,r.t=this.t+ds+1,r.s=this.s,r.clamp()},BigInteger2.prototype.rShiftTo=function(n,r){r.s=this.s;var ds=Math.floor(n/this.DB);if(ds>=this.t){r.t=0;return}var bs=n%this.DB,cbs=this.DB-bs,bm=(1<<bs)-1;r[0]=this[ds]>>bs;for(var i=ds+1;i<this.t;++i)r[i-ds-1]|=(this[i]&bm)<<cbs,r[i-ds]=this[i]>>bs;bs>0&&(r[this.t-ds-1]|=(this.s&bm)<<cbs),r.t=this.t-ds,r.clamp()},BigInteger2.prototype.subTo=function(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this[i]-a[i],r[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c-=a.s;i<this.t;)c+=this[i],r[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c-=a[i],r[i++]=c&this.DM,c>>=this.DB;c-=a.s}r.s=c<0?-1:0,c<-1?r[i++]=this.DV+c:c>0&&(r[i++]=c),r.t=i,r.clamp()},BigInteger2.prototype.multiplyTo=function(a,r){var x=this.abs(),y=a.abs(),i=x.t;for(r.t=i+y.t;--i>=0;)r[i]=0;for(i=0;i<y.t;++i)r[i+x.t]=x.am(0,y[i],r,i,0,x.t);r.s=0,r.clamp(),this.s!=a.s&&BigInteger2.ZERO.subTo(r,r)},BigInteger2.prototype.squareTo=function(r){for(var x=this.abs(),i=r.t=2*x.t;--i>=0;)r[i]=0;for(i=0;i<x.t-1;++i){var c=x.am(i,x[i],r,2*i,0,1);(r[i+x.t]+=x.am(i+1,2*x[i],r,2*i+1,c,x.t-i-1))>=x.DV&&(r[i+x.t]-=x.DV,r[i+x.t+1]=1)}r.t>0&&(r[r.t-1]+=x.am(i,x[i],r,2*i,0,1)),r.s=0,r.clamp()},BigInteger2.prototype.divRemTo=function(m,q,r){var pm=m.abs();if(!(pm.t<=0)){var pt=this.abs();if(pt.t<pm.t){q?.fromInt(0),r!=null&&this.copyTo(r);return}r==null&&(r=nbi());var y=nbi(),ts=this.s,ms=m.s,nsh=this.DB-nbits(pm[pm.t-1]);nsh>0?(pm.lShiftTo(nsh,y),pt.lShiftTo(nsh,r)):(pm.copyTo(y),pt.copyTo(r));var ys=y.t,y0=y[ys-1];if(y0!=0){var yt=y0*(1<<this.F1)+(ys>1?y[ys-2]>>this.F2:0),d1=this.FV/yt,d2=(1<<this.F1)/yt,e=1<<this.F2,i=r.t,j=i-ys,t2=q??nbi();for(y.dlShiftTo(j,t2),r.compareTo(t2)>=0&&(r[r.t++]=1,r.subTo(t2,r)),BigInteger2.ONE.dlShiftTo(ys,t2),t2.subTo(y,y);y.t<ys;)y[y.t++]=0;for(;--j>=0;){var qd=r[--i]==y0?this.DM:Math.floor(r[i]*d1+(r[i-1]+e)*d2);if((r[i]+=y.am(0,qd,r,j,0,ys))<qd)for(y.dlShiftTo(j,t2),r.subTo(t2,r);r[i]<--qd;)r.subTo(t2,r)}q!=null&&(r.drShiftTo(ys,q),ts!=ms&&BigInteger2.ZERO.subTo(q,q)),r.t=ys,r.clamp(),nsh>0&&r.rShiftTo(nsh,r),ts<0&&BigInteger2.ZERO.subTo(r,r)}}},BigInteger2.prototype.invDigit=function(){if(this.t<1)return 0;var x=this[0];if((x&1)==0)return 0;var y=x&3;return y=y*(2-(x&15)*y)&15,y=y*(2-(x&255)*y)&255,y=y*(2-((x&65535)*y&65535))&65535,y=y*(2-x*y%this.DV)%this.DV,y>0?this.DV-y:-y},BigInteger2.prototype.isEven=function(){return(this.t>0?this[0]&1:this.s)==0},BigInteger2.prototype.exp=function(e,z2){if(e>4294967295||e<1)return BigInteger2.ONE;var r=nbi(),r2=nbi(),g=z2.convert(this),i=nbits(e)-1;for(g.copyTo(r);--i>=0;)if(z2.sqrTo(r,r2),(e&1<<i)>0)z2.mulTo(r2,g,r);else{var t2=r;r=r2,r2=t2}return z2.revert(r)},BigInteger2.prototype.chunkSize=function(r){return Math.floor(Math.LN2*this.DB/Math.log(r))},BigInteger2.prototype.toRadix=function(b){if(b==null&&(b=10),this.signum()==0||b<2||b>36)return"0";var cs=this.chunkSize(b),a=Math.pow(b,cs),d=nbv(a),y=nbi(),z2=nbi(),r="";for(this.divRemTo(d,y,z2);y.signum()>0;)r=(a+z2.intValue()).toString(b).substr(1)+r,y.divRemTo(d,y,z2);return z2.intValue().toString(b)+r},BigInteger2.prototype.fromRadix=function(s,b){this.fromInt(0),b==null&&(b=10);for(var cs=this.chunkSize(b),d=Math.pow(b,cs),mi=!1,j=0,w=0,i=0;i<s.length;++i){var x=intAt(s,i);if(x<0){s.charAt(i)=="-"&&this.signum()==0&&(mi=!0);continue}w=b*w+x,++j>=cs&&(this.dMultiply(d),this.dAddOffset(w,0),j=0,w=0)}j>0&&(this.dMultiply(Math.pow(b,j)),this.dAddOffset(w,0)),mi&&BigInteger2.ZERO.subTo(this,this)},BigInteger2.prototype.fromNumber=function(a,b,c){if(typeof b=="number")if(a<2)this.fromInt(1);else for(this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger2.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(b);)this.dAddOffset(2,0),this.bitLength()>a&&this.subTo(BigInteger2.ONE.shiftLeft(a-1),this);else{var x=[],t2=a&7;x.length=(a>>3)+1,b.nextBytes(x),t2>0?x[0]&=(1<<t2)-1:x[0]=0,this.fromString(x,256)}},BigInteger2.prototype.bitwiseTo=function(a,op,r){var i,f,m=Math.min(a.t,this.t);for(i=0;i<m;++i)r[i]=op(this[i],a[i]);if(a.t<this.t){for(f=a.s&this.DM,i=m;i<this.t;++i)r[i]=op(this[i],f);r.t=this.t}else{for(f=this.s&this.DM,i=m;i<a.t;++i)r[i]=op(f,a[i]);r.t=a.t}r.s=op(this.s,a.s),r.clamp()},BigInteger2.prototype.changeBit=function(n,op){var r=BigInteger2.ONE.shiftLeft(n);return this.bitwiseTo(r,op,r),r},BigInteger2.prototype.addTo=function(a,r){for(var i=0,c=0,m=Math.min(a.t,this.t);i<m;)c+=this[i]+a[i],r[i++]=c&this.DM,c>>=this.DB;if(a.t<this.t){for(c+=a.s;i<this.t;)c+=this[i],r[i++]=c&this.DM,c>>=this.DB;c+=this.s}else{for(c+=this.s;i<a.t;)c+=a[i],r[i++]=c&this.DM,c>>=this.DB;c+=a.s}r.s=c<0?-1:0,c>0?r[i++]=c:c<-1&&(r[i++]=this.DV+c),r.t=i,r.clamp()},BigInteger2.prototype.dMultiply=function(n){this[this.t]=this.am(0,n-1,this,0,0,this.t),++this.t,this.clamp()},BigInteger2.prototype.dAddOffset=function(n,w){if(n!=0){for(;this.t<=w;)this[this.t++]=0;for(this[w]+=n;this[w]>=this.DV;)this[w]-=this.DV,++w>=this.t&&(this[this.t++]=0),++this[w]}},BigInteger2.prototype.multiplyLowerTo=function(a,n,r){var i=Math.min(this.t+a.t,n);for(r.s=0,r.t=i;i>0;)r[--i]=0;for(var j=r.t-this.t;i<j;++i)r[i+this.t]=this.am(0,a[i],r,i,0,this.t);for(j=Math.min(a.t,n);i<j;++i)this.am(0,a[i],r,i,0,n-i);r.clamp()},BigInteger2.prototype.multiplyUpperTo=function(a,n,r){--n;var i=r.t=this.t+a.t-n;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(n-this.t,0);i<a.t;++i)r[this.t+i-n]=this.am(n-i,a[i],r,0,0,this.t+i-n);r.clamp(),r.drShiftTo(1,r)},BigInteger2.prototype.modInt=function(n){if(n<=0)return 0;var d=this.DV%n,r=this.s<0?n-1:0;if(this.t>0)if(d==0)r=this[0]%n;else for(var i=this.t-1;i>=0;--i)r=(d*r+this[i])%n;return r},BigInteger2.prototype.millerRabin=function(t2){var n1=this.subtract(BigInteger2.ONE),k=n1.getLowestSetBit();if(k<=0)return!1;var r=n1.shiftRight(k);t2=t2+1>>1,t2>lowprimes.length&&(t2=lowprimes.length);for(var a=nbi(),i=0;i<t2;++i){a.fromInt(lowprimes[Math.floor(Math.random()*lowprimes.length)]);var y=a.modPow(r,this);if(y.compareTo(BigInteger2.ONE)!=0&&y.compareTo(n1)!=0){for(var j=1;j++<k&&y.compareTo(n1)!=0;)if(y=y.modPowInt(2,this),y.compareTo(BigInteger2.ONE)==0)return!1;if(y.compareTo(n1)!=0)return!1}}return!0},BigInteger2.prototype.square=function(){var r=nbi();return this.squareTo(r),r},BigInteger2.prototype.gcda=function(a,callback){var x=this.s<0?this.negate():this.clone(),y=a.s<0?a.negate():a.clone();if(x.compareTo(y)<0){var t2=x;x=y,y=t2}var i=x.getLowestSetBit(),g=y.getLowestSetBit();if(g<0){callback(x);return}i<g&&(g=i),g>0&&(x.rShiftTo(g,x),y.rShiftTo(g,y));var gcda1=function(){(i=x.getLowestSetBit())>0&&x.rShiftTo(i,x),(i=y.getLowestSetBit())>0&&y.rShiftTo(i,y),x.compareTo(y)>=0?(x.subTo(y,x),x.rShiftTo(1,x)):(y.subTo(x,y),y.rShiftTo(1,y)),x.signum()>0?setTimeout(gcda1,0):(g>0&&y.lShiftTo(g,y),setTimeout(function(){callback(y)},0))};setTimeout(gcda1,10)},BigInteger2.prototype.fromNumberAsync=function(a,b,c,callback){if(typeof b=="number")if(a<2)this.fromInt(1);else{this.fromNumber(a,c),this.testBit(a-1)||this.bitwiseTo(BigInteger2.ONE.shiftLeft(a-1),op_or,this),this.isEven()&&this.dAddOffset(1,0);var bnp_1=this,bnpfn1_1=function(){bnp_1.dAddOffset(2,0),bnp_1.bitLength()>a&&bnp_1.subTo(BigInteger2.ONE.shiftLeft(a-1),bnp_1),bnp_1.isProbablePrime(b)?setTimeout(function(){callback()},0):setTimeout(bnpfn1_1,0)};setTimeout(bnpfn1_1,0)}else{var x=[],t2=a&7;x.length=(a>>3)+1,b.nextBytes(x),t2>0?x[0]&=(1<<t2)-1:x[0]=0,this.fromString(x,256)}},BigInteger2}(),NullExp=function(){function NullExp2(){}return NullExp2.prototype.convert=function(x){return x},NullExp2.prototype.revert=function(x){return x},NullExp2.prototype.mulTo=function(x,y,r){x.multiplyTo(y,r)},NullExp2.prototype.sqrTo=function(x,r){x.squareTo(r)},NullExp2}(),Classic=function(){function Classic2(m){this.m=m}return Classic2.prototype.convert=function(x){return x.s<0||x.compareTo(this.m)>=0?x.mod(this.m):x},Classic2.prototype.revert=function(x){return x},Classic2.prototype.reduce=function(x){x.divRemTo(this.m,null,x)},Classic2.prototype.mulTo=function(x,y,r){x.multiplyTo(y,r),this.reduce(r)},Classic2.prototype.sqrTo=function(x,r){x.squareTo(r),this.reduce(r)},Classic2}(),Montgomery=function(){function Montgomery2(m){this.m=m,this.mp=m.invDigit(),this.mpl=this.mp&32767,this.mph=this.mp>>15,this.um=(1<<m.DB-15)-1,this.mt2=2*m.t}return Montgomery2.prototype.convert=function(x){var r=nbi();return x.abs().dlShiftTo(this.m.t,r),r.divRemTo(this.m,null,r),x.s<0&&r.compareTo(BigInteger.ZERO)>0&&this.m.subTo(r,r),r},Montgomery2.prototype.revert=function(x){var r=nbi();return x.copyTo(r),this.reduce(r),r},Montgomery2.prototype.reduce=function(x){for(;x.t<=this.mt2;)x[x.t++]=0;for(var i=0;i<this.m.t;++i){var j=x[i]&32767,u0=j*this.mpl+((j*this.mph+(x[i]>>15)*this.mpl&this.um)<<15)&x.DM;for(j=i+this.m.t,x[j]+=this.m.am(0,u0,x,i,0,this.m.t);x[j]>=x.DV;)x[j]-=x.DV,x[++j]++}x.clamp(),x.drShiftTo(this.m.t,x),x.compareTo(this.m)>=0&&x.subTo(this.m,x)},Montgomery2.prototype.mulTo=function(x,y,r){x.multiplyTo(y,r),this.reduce(r)},Montgomery2.prototype.sqrTo=function(x,r){x.squareTo(r),this.reduce(r)},Montgomery2}(),Barrett=function(){function Barrett2(m){this.m=m,this.r2=nbi(),this.q3=nbi(),BigInteger.ONE.dlShiftTo(2*m.t,this.r2),this.mu=this.r2.divide(m)}return Barrett2.prototype.convert=function(x){if(x.s<0||x.t>2*this.m.t)return x.mod(this.m);if(x.compareTo(this.m)<0)return x;var r=nbi();return x.copyTo(r),this.reduce(r),r},Barrett2.prototype.revert=function(x){return x},Barrett2.prototype.reduce=function(x){for(x.drShiftTo(this.m.t-1,this.r2),x.t>this.m.t+1&&(x.t=this.m.t+1,x.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);x.compareTo(this.r2)<0;)x.dAddOffset(1,this.m.t+1);for(x.subTo(this.r2,x);x.compareTo(this.m)>=0;)x.subTo(this.m,x)},Barrett2.prototype.mulTo=function(x,y,r){x.multiplyTo(y,r),this.reduce(r)},Barrett2.prototype.sqrTo=function(x,r){x.squareTo(r),this.reduce(r)},Barrett2}();function nbi(){return new BigInteger(null)}function parseBigInt(str,r){return new BigInteger(str,r)}var inBrowser=typeof navigator<"u";inBrowser&&j_lm&&navigator.appName=="Microsoft Internet Explorer"?(BigInteger.prototype.am=function(i,x,w,j,c,n){for(var xl=x&32767,xh=x>>15;--n>=0;){var l=this[i]&32767,h=this[i++]>>15,m=xh*l+h*xl;l=xl*l+((m&32767)<<15)+w[j]+(c&1073741823),c=(l>>>30)+(m>>>15)+xh*h+(c>>>30),w[j++]=l&1073741823}return c},dbits=30):inBrowser&&j_lm&&navigator.appName!="Netscape"?(BigInteger.prototype.am=function(i,x,w,j,c,n){for(;--n>=0;){var v=x*this[i++]+w[j]+c;c=Math.floor(v/67108864),w[j++]=v&67108863}return c},dbits=26):(BigInteger.prototype.am=function(i,x,w,j,c,n){for(var xl=x&16383,xh=x>>14;--n>=0;){var l=this[i]&16383,h=this[i++]>>14,m=xh*l+h*xl;l=xl*l+((m&16383)<<14)+w[j]+c,c=(l>>28)+(m>>14)+xh*h,w[j++]=l&268435455}return c},dbits=28),BigInteger.prototype.DB=dbits,BigInteger.prototype.DM=(1<<dbits)-1,BigInteger.prototype.DV=1<<dbits;var BI_FP=52;BigInteger.prototype.FV=Math.pow(2,BI_FP),BigInteger.prototype.F1=BI_FP-dbits,BigInteger.prototype.F2=2*dbits-BI_FP;var BI_RC=[],rr,vv;for(rr=48,vv=0;vv<=9;++vv)BI_RC[rr++]=vv;for(rr=97,vv=10;vv<36;++vv)BI_RC[rr++]=vv;for(rr=65,vv=10;vv<36;++vv)BI_RC[rr++]=vv;function intAt(s,i){var c=BI_RC[s.charCodeAt(i)];return c??-1}function nbv(i){var r=nbi();return r.fromInt(i),r}function nbits(x){var r=1,t2;return(t2=x>>>16)!=0&&(x=t2,r+=16),(t2=x>>8)!=0&&(x=t2,r+=8),(t2=x>>4)!=0&&(x=t2,r+=4),(t2=x>>2)!=0&&(x=t2,r+=2),(t2=x>>1)!=0&&(x=t2,r+=1),r}BigInteger.ZERO=nbv(0),BigInteger.ONE=nbv(1);var Arcfour=function(){function Arcfour2(){this.i=0,this.j=0,this.S=[]}return Arcfour2.prototype.init=function(key){var i,j,t2;for(i=0;i<256;++i)this.S[i]=i;for(j=0,i=0;i<256;++i)j=j+this.S[i]+key[i%key.length]&255,t2=this.S[i],this.S[i]=this.S[j],this.S[j]=t2;this.i=0,this.j=0},Arcfour2.prototype.next=function(){var t2;return this.i=this.i+1&255,this.j=this.j+this.S[this.i]&255,t2=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=t2,this.S[t2+this.S[this.i]&255]},Arcfour2}();function prng_newstate(){return new Arcfour}var rng_psize=256,rng_state,rng_pool=null,rng_pptr;if(rng_pool==null){if(rng_pool=[],rng_pptr=0,t=void 0,typeof window<"u"&&window.crypto&&window.crypto.getRandomValues)for(z=new Uint32Array(256),window.crypto.getRandomValues(z),t=0;t<z.length;++t)rng_pool[rng_pptr++]=z[t]&255;count=0,onMouseMoveListener_1=function(ev){if(count=count||0,count>=256||rng_pptr>=rng_psize){window.removeEventListener?window.removeEventListener("mousemove",onMouseMoveListener_1,!1):window.detachEvent&&window.detachEvent("onmousemove",onMouseMoveListener_1);return}try{var mouseCoordinates=ev.x+ev.y;rng_pool[rng_pptr++]=mouseCoordinates&255,count+=1}catch{}},typeof window<"u"&&(window.addEventListener?window.addEventListener("mousemove",onMouseMoveListener_1,!1):window.attachEvent&&window.attachEvent("onmousemove",onMouseMoveListener_1))}var t,z,count,onMouseMoveListener_1;function rng_get_byte(){if(rng_state==null){for(rng_state=prng_newstate();rng_pptr<rng_psize;){var random=Math.floor(65536*Math.random());rng_pool[rng_pptr++]=random&255}for(rng_state.init(rng_pool),rng_pptr=0;rng_pptr<rng_pool.length;++rng_pptr)rng_pool[rng_pptr]=0;rng_pptr=0}return rng_state.next()}var SecureRandom=function(){function SecureRandom2(){}return SecureRandom2.prototype.nextBytes=function(ba){for(var i=0;i<ba.length;++i)ba[i]=rng_get_byte()},SecureRandom2}();function pkcs1pad1(s,n){if(n<s.length+22)return console.error("Message too long for RSA"),null;for(var len=n-s.length-6,filler="",f=0;f<len;f+=2)filler+="ff";var m="0001"+filler+"00"+s;return parseBigInt(m,16)}function pkcs1pad2(s,n){if(n<s.length+11)return console.error("Message too long for RSA"),null;for(var ba=[],i=s.length-1;i>=0&&n>0;){var c=s.charCodeAt(i--);c<128?ba[--n]=c:c>127&&c<2048?(ba[--n]=c&63|128,ba[--n]=c>>6|192):(ba[--n]=c&63|128,ba[--n]=c>>6&63|128,ba[--n]=c>>12|224)}ba[--n]=0;for(var rng=new SecureRandom,x=[];n>2;){for(x[0]=0;x[0]==0;)rng.nextBytes(x);ba[--n]=x[0]}return ba[--n]=2,ba[--n]=0,new BigInteger(ba)}var RSAKey=function(){function RSAKey2(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}return RSAKey2.prototype.doPublic=function(x){return x.modPowInt(this.e,this.n)},RSAKey2.prototype.doPrivate=function(x){if(this.p==null||this.q==null)return x.modPow(this.d,this.n);for(var xp=x.mod(this.p).modPow(this.dmp1,this.p),xq=x.mod(this.q).modPow(this.dmq1,this.q);xp.compareTo(xq)<0;)xp=xp.add(this.p);return xp.subtract(xq).multiply(this.coeff).mod(this.p).multiply(this.q).add(xq)},RSAKey2.prototype.setPublic=function(N,E){N!=null&&E!=null&&N.length>0&&E.length>0?(this.n=parseBigInt(N,16),this.e=parseInt(E,16)):console.error("Invalid RSA public key")},RSAKey2.prototype.encrypt=function(text){var maxLength=this.n.bitLength()+7>>3,m=pkcs1pad2(text,maxLength);if(m==null)return null;var c=this.doPublic(m);if(c==null)return null;for(var h=c.toString(16),length=h.length,i=0;i<maxLength*2-length;i++)h="0"+h;return h},RSAKey2.prototype.setPrivate=function(N,E,D){N!=null&&E!=null&&N.length>0&&E.length>0?(this.n=parseBigInt(N,16),this.e=parseInt(E,16),this.d=parseBigInt(D,16)):console.error("Invalid RSA private key")},RSAKey2.prototype.setPrivateEx=function(N,E,D,P,Q,DP,DQ,C){N!=null&&E!=null&&N.length>0&&E.length>0?(this.n=parseBigInt(N,16),this.e=parseInt(E,16),this.d=parseBigInt(D,16),this.p=parseBigInt(P,16),this.q=parseBigInt(Q,16),this.dmp1=parseBigInt(DP,16),this.dmq1=parseBigInt(DQ,16),this.coeff=parseBigInt(C,16)):console.error("Invalid RSA private key")},RSAKey2.prototype.generate=function(B,E){var rng=new SecureRandom,qs=B>>1;this.e=parseInt(E,16);for(var ee=new BigInteger(E,16);;){for(;this.p=new BigInteger(B-qs,1,rng),!(this.p.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.p.isProbablePrime(10)););for(;this.q=new BigInteger(qs,1,rng),!(this.q.subtract(BigInteger.ONE).gcd(ee).compareTo(BigInteger.ONE)==0&&this.q.isProbablePrime(10)););if(this.p.compareTo(this.q)<=0){var t2=this.p;this.p=this.q,this.q=t2}var p1=this.p.subtract(BigInteger.ONE),q1=this.q.subtract(BigInteger.ONE),phi=p1.multiply(q1);if(phi.gcd(ee).compareTo(BigInteger.ONE)==0){this.n=this.p.multiply(this.q),this.d=ee.modInverse(phi),this.dmp1=this.d.mod(p1),this.dmq1=this.d.mod(q1),this.coeff=this.q.modInverse(this.p);break}}},RSAKey2.prototype.decrypt=function(ctext){var c=parseBigInt(ctext,16),m=this.doPrivate(c);return m==null?null:pkcs1unpad2(m,this.n.bitLength()+7>>3)},RSAKey2.prototype.generateAsync=function(B,E,callback){var rng=new SecureRandom,qs=B>>1;this.e=parseInt(E,16);var ee=new BigInteger(E,16),rsa=this,loop1=function(){var loop4=function(){if(rsa.p.compareTo(rsa.q)<=0){var t2=rsa.p;rsa.p=rsa.q,rsa.q=t2}var p1=rsa.p.subtract(BigInteger.ONE),q1=rsa.q.subtract(BigInteger.ONE),phi=p1.multiply(q1);phi.gcd(ee).compareTo(BigInteger.ONE)==0?(rsa.n=rsa.p.multiply(rsa.q),rsa.d=ee.modInverse(phi),rsa.dmp1=rsa.d.mod(p1),rsa.dmq1=rsa.d.mod(q1),rsa.coeff=rsa.q.modInverse(rsa.p),setTimeout(function(){callback()},0)):setTimeout(loop1,0)},loop3=function(){rsa.q=nbi(),rsa.q.fromNumberAsync(qs,1,rng,function(){rsa.q.subtract(BigInteger.ONE).gcda(ee,function(r){r.compareTo(BigInteger.ONE)==0&&rsa.q.isProbablePrime(10)?setTimeout(loop4,0):setTimeout(loop3,0)})})},loop2=function(){rsa.p=nbi(),rsa.p.fromNumberAsync(B-qs,1,rng,function(){rsa.p.subtract(BigInteger.ONE).gcda(ee,function(r){r.compareTo(BigInteger.ONE)==0&&rsa.p.isProbablePrime(10)?setTimeout(loop3,0):setTimeout(loop2,0)})})};setTimeout(loop2,0)};setTimeout(loop1,0)},RSAKey2.prototype.sign=function(text,digestMethod,digestName){var header=getDigestHeader(digestName),digest=header+digestMethod(text).toString(),m=pkcs1pad1(digest,this.n.bitLength()/4);if(m==null)return null;var c=this.doPrivate(m);if(c==null)return null;var h=c.toString(16);return(h.length&1)==0?h:"0"+h},RSAKey2.prototype.verify=function(text,signature,digestMethod){var c=parseBigInt(signature,16),m=this.doPublic(c);if(m==null)return null;var unpadded=m.toString(16).replace(/^1f+00/,""),digest=removeDigestHeader(unpadded);return digest==digestMethod(text).toString()},RSAKey2}();function pkcs1unpad2(d,n){for(var b=d.toByteArray(),i=0;i<b.length&&b[i]==0;)++i;if(b.length-i!=n-1||b[i]!=2)return null;for(++i;b[i]!=0;)if(++i>=b.length)return null;for(var ret="";++i<b.length;){var c=b[i]&255;c<128?ret+=String.fromCharCode(c):c>191&&c<224?(ret+=String.fromCharCode((c&31)<<6|b[i+1]&63),++i):(ret+=String.fromCharCode((c&15)<<12|(b[i+1]&63)<<6|b[i+2]&63),i+=2)}return ret}var DIGEST_HEADERS={md2:"3020300c06082a864886f70d020205000410",md5:"3020300c06082a864886f70d020505000410",sha1:"3021300906052b0e03021a05000414",sha224:"302d300d06096086480165030402040500041c",sha256:"3031300d060960864801650304020105000420",sha384:"3041300d060960864801650304020205000430",sha512:"3051300d060960864801650304020305000440",ripemd160:"3021300906052b2403020105000414"};function getDigestHeader(name){return DIGEST_HEADERS[name]||""}function removeDigestHeader(str){for(var name_1 in DIGEST_HEADERS)if(DIGEST_HEADERS.hasOwnProperty(name_1)){var header=DIGEST_HEADERS[name_1],len=header.length;if(str.substr(0,len)==header)return str.substr(len)}return str}var YAHOO={};YAHOO.lang={extend:function(subc,superc,overrides){if(!superc||!subc)throw new Error("YAHOO.lang.extend failed, please check that all dependencies are included.");var F=function(){};if(F.prototype=superc.prototype,subc.prototype=new F,subc.prototype.constructor=subc,subc.superclass=superc.prototype,superc.prototype.constructor==Object.prototype.constructor&&(superc.prototype.constructor=superc),overrides){var i;for(i in overrides)subc.prototype[i]=overrides[i];var _IEEnumFix=function(){},ADD=["toString","valueOf"];try{/MSIE/.test(navigator.userAgent)&&(_IEEnumFix=function(r,s){for(i=0;i<ADD.length;i=i+1){var fname=ADD[i],f=s[fname];typeof f=="function"&&f!=Object.prototype[fname]&&(r[fname]=f)}})}catch{}_IEEnumFix(subc.prototype,overrides)}}};var KJUR={};(typeof KJUR.asn1>"u"||!KJUR.asn1)&&(KJUR.asn1={}),KJUR.asn1.ASN1Util=new function(){this.integerToByteHex=function(i){var h=i.toString(16);return h.length%2==1&&(h="0"+h),h},this.bigIntToMinTwosComplementsHex=function(bigIntegerValue){var h=bigIntegerValue.toString(16);if(h.substr(0,1)!="-")h.length%2==1?h="0"+h:h.match(/^[0-7]/)||(h="00"+h);else{var hPos=h.substr(1),xorLen=hPos.length;xorLen%2==1?xorLen+=1:h.match(/^[0-7]/)||(xorLen+=2);for(var hMask="",i=0;i<xorLen;i++)hMask+="f";var biMask=new BigInteger(hMask,16),biNeg=biMask.xor(bigIntegerValue).add(BigInteger.ONE);h=biNeg.toString(16).replace(/^-/,"")}return h},this.getPEMStringFromHex=function(dataHex,pemHeader){return hextopem(dataHex,pemHeader)},this.newObject=function(param){var _KJUR=KJUR,_KJUR_asn1=_KJUR.asn1,_DERBoolean=_KJUR_asn1.DERBoolean,_DERInteger=_KJUR_asn1.DERInteger,_DERBitString=_KJUR_asn1.DERBitString,_DEROctetString=_KJUR_asn1.DEROctetString,_DERNull=_KJUR_asn1.DERNull,_DERObjectIdentifier=_KJUR_asn1.DERObjectIdentifier,_DEREnumerated=_KJUR_asn1.DEREnumerated,_DERUTF8String=_KJUR_asn1.DERUTF8String,_DERNumericString=_KJUR_asn1.DERNumericString,_DERPrintableString=_KJUR_asn1.DERPrintableString,_DERTeletexString=_KJUR_asn1.DERTeletexString,_DERIA5String=_KJUR_asn1.DERIA5String,_DERUTCTime=_KJUR_asn1.DERUTCTime,_DERGeneralizedTime=_KJUR_asn1.DERGeneralizedTime,_DERSequence=_KJUR_asn1.DERSequence,_DERSet=_KJUR_asn1.DERSet,_DERTaggedObject=_KJUR_asn1.DERTaggedObject,_newObject=_KJUR_asn1.ASN1Util.newObject,keys=Object.keys(param);if(keys.length!=1)throw"key of param shall be only one.";var key=keys[0];if(":bool:int:bitstr:octstr:null:oid:enum:utf8str:numstr:prnstr:telstr:ia5str:utctime:gentime:seq:set:tag:".indexOf(":"+key+":")==-1)throw"undefined key: "+key;if(key=="bool")return new _DERBoolean(param[key]);if(key=="int")return new _DERInteger(param[key]);if(key=="bitstr")return new _DERBitString(param[key]);if(key=="octstr")return new _DEROctetString(param[key]);if(key=="null")return new _DERNull(param[key]);if(key=="oid")return new _DERObjectIdentifier(param[key]);if(key=="enum")return new _DEREnumerated(param[key]);if(key=="utf8str")return new _DERUTF8String(param[key]);if(key=="numstr")return new _DERNumericString(param[key]);if(key=="prnstr")return new _DERPrintableString(param[key]);if(key=="telstr")return new _DERTeletexString(param[key]);if(key=="ia5str")return new _DERIA5String(param[key]);if(key=="utctime")return new _DERUTCTime(param[key]);if(key=="gentime")return new _DERGeneralizedTime(param[key]);var paramList,a,asn1Obj;if(key=="seq"){paramList=param[key],a=[];for(var i=0;i<paramList.length;i++)asn1Obj=_newObject(paramList[i]),a.push(asn1Obj);return new _DERSequence({array:a})}if(key=="set"){paramList=param[key],a=[];for(var j=0;j<paramList.length;j++)asn1Obj=_newObject(paramList[j]),a.push(asn1Obj);return new _DERSet({array:a})}if(key=="tag"){var tagParam=param[key];if(Object.prototype.toString.call(tagParam)==="[object Array]"&&tagParam.length==3){var obj=_newObject(tagParam[2]);return new _DERTaggedObject({tag:tagParam[0],explicit:tagParam[1],obj})}else{var newParam={};if(tagParam.explicit!==void 0&&(newParam.explicit=tagParam.explicit),tagParam.tag!==void 0&&(newParam.tag=tagParam.tag),tagParam.obj===void 0)throw"obj shall be specified for 'tag'.";return newParam.obj=_newObject(tagParam.obj),new _DERTaggedObject(newParam)}}},this.jsonToASN1HEX=function(param){var asn1Obj=this.newObject(param);return asn1Obj.getEncodedHex()}},KJUR.asn1.ASN1Util.oidHexToInt=function(hex){var s="",i01=parseInt(hex.substr(0,2),16),i0=Math.floor(i01/40),i1=i01%40;s=i0+"."+i1;for(var binbuf="",i=2;i<hex.length;i+=2){var value=parseInt(hex.substr(i,2),16),bin=("00000000"+value.toString(2)).slice(-8);if(binbuf=binbuf+bin.substr(1,7),bin.substr(0,1)=="0"){var bi=new BigInteger(binbuf,2);s=s+"."+bi.toString(10),binbuf=""}}return s},KJUR.asn1.ASN1Util.oidIntToHex=function(oidString){var itox=function(i2){var h2=i2.toString(16);return h2.length==1&&(h2="0"+h2),h2},roidtox=function(roid){var h2="",bi=new BigInteger(roid,10),b=bi.toString(2),padLen=7-b.length%7;padLen==7&&(padLen=0);for(var bPad="",ii2=0;ii2<padLen;ii2++)bPad+="0";b=bPad+b;for(var i2=0;i2<b.length-1;i2+=7){var b8=b.substr(i2,7);i2!=b.length-7&&(b8="1"+b8),h2+=itox(parseInt(b8,2))}return h2};if(!oidString.match(/^[0-9.]+$/))throw"malformed oid string: "+oidString;var h="",a=oidString.split("."),i0=parseInt(a[0])*40+parseInt(a[1]);h+=itox(i0),a.splice(0,2);for(var i=0;i<a.length;i++)h+=roidtox(a[i]);return h},KJUR.asn1.ASN1Object=function(){var isModified=!0,hTLV=null,hT="00",hL="00",hV="";this.getLengthHexFromValue=function(){if(typeof this.hV>"u"||this.hV==null)throw"this.hV is null or undefined.";if(this.hV.length%2==1)throw"value hex must be even length: n="+hV.length+",v="+this.hV;var n=this.hV.length/2,hN=n.toString(16);if(hN.length%2==1&&(hN="0"+hN),n<128)return hN;var hNlen=hN.length/2;if(hNlen>15)throw"ASN.1 length too long to represent by 8x: n = "+n.toString(16);var head=128+hNlen;return head.toString(16)+hN},this.getEncodedHex=function(){return(this.hTLV==null||this.isModified)&&(this.hV=this.getFreshValueHex(),this.hL=this.getLengthHexFromValue(),this.hTLV=this.hT+this.hL+this.hV,this.isModified=!1),this.hTLV},this.getValueHex=function(){return this.getEncodedHex(),this.hV},this.getFreshValueHex=function(){return""}},KJUR.asn1.DERAbstractString=function(params){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var s=null,hV=null;this.getString=function(){return this.s},this.setString=function(newS){this.hTLV=null,this.isModified=!0,this.s=newS,this.hV=stohex(this.s)},this.setStringHex=function(newHexString){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=newHexString},this.getFreshValueHex=function(){return this.hV},typeof params<"u"&&(typeof params=="string"?this.setString(params):typeof params.str<"u"?this.setString(params.str):typeof params.hex<"u"&&this.setStringHex(params.hex))},YAHOO.lang.extend(KJUR.asn1.DERAbstractString,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractTime=function(params){KJUR.asn1.DERAbstractTime.superclass.constructor.call(this);var s=null,date=null;this.localDateToUTC=function(d){utc=d.getTime()+d.getTimezoneOffset()*6e4;var utcDate=new Date(utc);return utcDate},this.formatDate=function(dateObject,type,withMillis){var pad=this.zeroPadding,d=this.localDateToUTC(dateObject),year=String(d.getFullYear());type=="utc"&&(year=year.substr(2,2));var month=pad(String(d.getMonth()+1),2),day=pad(String(d.getDate()),2),hour=pad(String(d.getHours()),2),min=pad(String(d.getMinutes()),2),sec=pad(String(d.getSeconds()),2),s2=year+month+day+hour+min+sec;if(withMillis===!0){var millis=d.getMilliseconds();if(millis!=0){var sMillis=pad(String(millis),3);sMillis=sMillis.replace(/[0]+$/,""),s2=s2+"."+sMillis}}return s2+"Z"},this.zeroPadding=function(s2,len){return s2.length>=len?s2:new Array(len-s2.length+1).join("0")+s2},this.getString=function(){return this.s},this.setString=function(newS){this.hTLV=null,this.isModified=!0,this.s=newS,this.hV=stohex(newS)},this.setByDateValue=function(year,month,day,hour,min,sec){var dateObject=new Date(Date.UTC(year,month-1,day,hour,min,sec,0));this.setByDate(dateObject)},this.getFreshValueHex=function(){return this.hV}},YAHOO.lang.extend(KJUR.asn1.DERAbstractTime,KJUR.asn1.ASN1Object),KJUR.asn1.DERAbstractStructured=function(params){KJUR.asn1.DERAbstractString.superclass.constructor.call(this);var asn1Array=null;this.setByASN1ObjectArray=function(asn1ObjectArray){this.hTLV=null,this.isModified=!0,this.asn1Array=asn1ObjectArray},this.appendASN1Object=function(asn1Object){this.hTLV=null,this.isModified=!0,this.asn1Array.push(asn1Object)},this.asn1Array=[],typeof params<"u"&&typeof params.array<"u"&&(this.asn1Array=params.array)},YAHOO.lang.extend(KJUR.asn1.DERAbstractStructured,KJUR.asn1.ASN1Object),KJUR.asn1.DERBoolean=function(){KJUR.asn1.DERBoolean.superclass.constructor.call(this),this.hT="01",this.hTLV="0101ff"},YAHOO.lang.extend(KJUR.asn1.DERBoolean,KJUR.asn1.ASN1Object),KJUR.asn1.DERInteger=function(params){KJUR.asn1.DERInteger.superclass.constructor.call(this),this.hT="02",this.setByBigInteger=function(bigIntegerValue){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(bigIntegerValue)},this.setByInteger=function(intValue){var bi=new BigInteger(String(intValue),10);this.setByBigInteger(bi)},this.setValueHex=function(newHexString){this.hV=newHexString},this.getFreshValueHex=function(){return this.hV},typeof params<"u"&&(typeof params.bigint<"u"?this.setByBigInteger(params.bigint):typeof params.int<"u"?this.setByInteger(params.int):typeof params=="number"?this.setByInteger(params):typeof params.hex<"u"&&this.setValueHex(params.hex))},YAHOO.lang.extend(KJUR.asn1.DERInteger,KJUR.asn1.ASN1Object),KJUR.asn1.DERBitString=function(params){if(params!==void 0&&typeof params.obj<"u"){var o=KJUR.asn1.ASN1Util.newObject(params.obj);params.hex="00"+o.getEncodedHex()}KJUR.asn1.DERBitString.superclass.constructor.call(this),this.hT="03",this.setHexValueIncludingUnusedBits=function(newHexStringIncludingUnusedBits){this.hTLV=null,this.isModified=!0,this.hV=newHexStringIncludingUnusedBits},this.setUnusedBitsAndHexValue=function(unusedBits,hValue){if(unusedBits<0||7<unusedBits)throw"unused bits shall be from 0 to 7: u = "+unusedBits;var hUnusedBits="0"+unusedBits;this.hTLV=null,this.isModified=!0,this.hV=hUnusedBits+hValue},this.setByBinaryString=function(binaryString){binaryString=binaryString.replace(/0+$/,"");var unusedBits=8-binaryString.length%8;unusedBits==8&&(unusedBits=0);for(var ii=0;ii<=unusedBits;ii++)binaryString+="0";for(var h="",i=0;i<binaryString.length-1;i+=8){var b=binaryString.substr(i,8),x=parseInt(b,2).toString(16);x.length==1&&(x="0"+x),h+=x}this.hTLV=null,this.isModified=!0,this.hV="0"+unusedBits+h},this.setByBooleanArray=function(booleanArray){for(var s="",i=0;i<booleanArray.length;i++)booleanArray[i]==!0?s+="1":s+="0";this.setByBinaryString(s)},this.newFalseArray=function(nLength){for(var a=new Array(nLength),i=0;i<nLength;i++)a[i]=!1;return a},this.getFreshValueHex=function(){return this.hV},typeof params<"u"&&(typeof params=="string"&&params.toLowerCase().match(/^[0-9a-f]+$/)?this.setHexValueIncludingUnusedBits(params):typeof params.hex<"u"?this.setHexValueIncludingUnusedBits(params.hex):typeof params.bin<"u"?this.setByBinaryString(params.bin):typeof params.array<"u"&&this.setByBooleanArray(params.array))},YAHOO.lang.extend(KJUR.asn1.DERBitString,KJUR.asn1.ASN1Object),KJUR.asn1.DEROctetString=function(params){if(params!==void 0&&typeof params.obj<"u"){var o=KJUR.asn1.ASN1Util.newObject(params.obj);params.hex=o.getEncodedHex()}KJUR.asn1.DEROctetString.superclass.constructor.call(this,params),this.hT="04"},YAHOO.lang.extend(KJUR.asn1.DEROctetString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNull=function(){KJUR.asn1.DERNull.superclass.constructor.call(this),this.hT="05",this.hTLV="0500"},YAHOO.lang.extend(KJUR.asn1.DERNull,KJUR.asn1.ASN1Object),KJUR.asn1.DERObjectIdentifier=function(params){var itox=function(i){var h=i.toString(16);return h.length==1&&(h="0"+h),h},roidtox=function(roid){var h="",bi=new BigInteger(roid,10),b=bi.toString(2),padLen=7-b.length%7;padLen==7&&(padLen=0);for(var bPad="",i=0;i<padLen;i++)bPad+="0";b=bPad+b;for(var ii=0;ii<b.length-1;ii+=7){var b8=b.substr(ii,7);ii!=b.length-7&&(b8="1"+b8),h+=itox(parseInt(b8,2))}return h};KJUR.asn1.DERObjectIdentifier.superclass.constructor.call(this),this.hT="06",this.setValueHex=function(newHexString){this.hTLV=null,this.isModified=!0,this.s=null,this.hV=newHexString},this.setValueOidString=function(oidString){if(!oidString.match(/^[0-9.]+$/))throw"malformed oid string: "+oidString;var h="",a=oidString.split("."),i0=parseInt(a[0])*40+parseInt(a[1]);h+=itox(i0),a.splice(0,2);for(var i=0;i<a.length;i++)h+=roidtox(a[i]);this.hTLV=null,this.isModified=!0,this.s=null,this.hV=h},this.setValueName=function(oidName){var oid=KJUR.asn1.x509.OID.name2oid(oidName);if(oid!=="")this.setValueOidString(oid);else throw"DERObjectIdentifier oidName undefined: "+oidName},this.getFreshValueHex=function(){return this.hV},params!==void 0&&(typeof params=="string"?params.match(/^[0-2].[0-9.]+$/)?this.setValueOidString(params):this.setValueName(params):params.oid!==void 0?this.setValueOidString(params.oid):params.hex!==void 0?this.setValueHex(params.hex):params.name!==void 0&&this.setValueName(params.name))},YAHOO.lang.extend(KJUR.asn1.DERObjectIdentifier,KJUR.asn1.ASN1Object),KJUR.asn1.DEREnumerated=function(params){KJUR.asn1.DEREnumerated.superclass.constructor.call(this),this.hT="0a",this.setByBigInteger=function(bigIntegerValue){this.hTLV=null,this.isModified=!0,this.hV=KJUR.asn1.ASN1Util.bigIntToMinTwosComplementsHex(bigIntegerValue)},this.setByInteger=function(intValue){var bi=new BigInteger(String(intValue),10);this.setByBigInteger(bi)},this.setValueHex=function(newHexString){this.hV=newHexString},this.getFreshValueHex=function(){return this.hV},typeof params<"u"&&(typeof params.int<"u"?this.setByInteger(params.int):typeof params=="number"?this.setByInteger(params):typeof params.hex<"u"&&this.setValueHex(params.hex))},YAHOO.lang.extend(KJUR.asn1.DEREnumerated,KJUR.asn1.ASN1Object),KJUR.asn1.DERUTF8String=function(params){KJUR.asn1.DERUTF8String.superclass.constructor.call(this,params),this.hT="0c"},YAHOO.lang.extend(KJUR.asn1.DERUTF8String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERNumericString=function(params){KJUR.asn1.DERNumericString.superclass.constructor.call(this,params),this.hT="12"},YAHOO.lang.extend(KJUR.asn1.DERNumericString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERPrintableString=function(params){KJUR.asn1.DERPrintableString.superclass.constructor.call(this,params),this.hT="13"},YAHOO.lang.extend(KJUR.asn1.DERPrintableString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERTeletexString=function(params){KJUR.asn1.DERTeletexString.superclass.constructor.call(this,params),this.hT="14"},YAHOO.lang.extend(KJUR.asn1.DERTeletexString,KJUR.asn1.DERAbstractString),KJUR.asn1.DERIA5String=function(params){KJUR.asn1.DERIA5String.superclass.constructor.call(this,params),this.hT="16"},YAHOO.lang.extend(KJUR.asn1.DERIA5String,KJUR.asn1.DERAbstractString),KJUR.asn1.DERUTCTime=function(params){KJUR.asn1.DERUTCTime.superclass.constructor.call(this,params),this.hT="17",this.setByDate=function(dateObject){this.hTLV=null,this.isModified=!0,this.date=dateObject,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return typeof this.date>"u"&&typeof this.s>"u"&&(this.date=new Date,this.s=this.formatDate(this.date,"utc"),this.hV=stohex(this.s)),this.hV},params!==void 0&&(params.str!==void 0?this.setString(params.str):typeof params=="string"&&params.match(/^[0-9]{12}Z$/)?this.setString(params):params.hex!==void 0?this.setStringHex(params.hex):params.date!==void 0&&this.setByDate(params.date))},YAHOO.lang.extend(KJUR.asn1.DERUTCTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERGeneralizedTime=function(params){KJUR.asn1.DERGeneralizedTime.superclass.constructor.call(this,params),this.hT="18",this.withMillis=!1,this.setByDate=function(dateObject){this.hTLV=null,this.isModified=!0,this.date=dateObject,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)},this.getFreshValueHex=function(){return this.date===void 0&&this.s===void 0&&(this.date=new Date,this.s=this.formatDate(this.date,"gen",this.withMillis),this.hV=stohex(this.s)),this.hV},params!==void 0&&(params.str!==void 0?this.setString(params.str):typeof params=="string"&&params.match(/^[0-9]{14}Z$/)?this.setString(params):params.hex!==void 0?this.setStringHex(params.hex):params.date!==void 0&&this.setByDate(params.date),params.millis===!0&&(this.withMillis=!0))},YAHOO.lang.extend(KJUR.asn1.DERGeneralizedTime,KJUR.asn1.DERAbstractTime),KJUR.asn1.DERSequence=function(params){KJUR.asn1.DERSequence.superclass.constructor.call(this,params),this.hT="30",this.getFreshValueHex=function(){for(var h="",i=0;i<this.asn1Array.length;i++){var asn1Obj=this.asn1Array[i];h+=asn1Obj.getEncodedHex()}return this.hV=h,this.hV}},YAHOO.lang.extend(KJUR.asn1.DERSequence,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERSet=function(params){KJUR.asn1.DERSet.superclass.constructor.call(this,params),this.hT="31",this.sortFlag=!0,this.getFreshValueHex=function(){for(var a=[],i=0;i<this.asn1Array.length;i++){var asn1Obj=this.asn1Array[i];a.push(asn1Obj.getEncodedHex())}return this.sortFlag==!0&&a.sort(),this.hV=a.join(""),this.hV},typeof params<"u"&&typeof params.sortflag<"u"&&params.sortflag==!1&&(this.sortFlag=!1)},YAHOO.lang.extend(KJUR.asn1.DERSet,KJUR.asn1.DERAbstractStructured),KJUR.asn1.DERTaggedObject=function(params){KJUR.asn1.DERTaggedObject.superclass.constructor.call(this),this.hT="a0",this.hV="",this.isExplicit=!0,this.asn1Object=null,this.setASN1Object=function(isExplicitFlag,tagNoHex,asn1Object){this.hT=tagNoHex,this.isExplicit=isExplicitFlag,this.asn1Object=asn1Object,this.isExplicit?(this.hV=this.asn1Object.getEncodedHex(),this.hTLV=null,this.isModified=!0):(this.hV=null,this.hTLV=asn1Object.getEncodedHex(),this.hTLV=this.hTLV.replace(/^../,tagNoHex),this.isModified=!1)},this.getFreshValueHex=function(){return this.hV},typeof params<"u"&&(typeof params.tag<"u"&&(this.hT=params.tag),typeof params.explicit<"u"&&(this.isExplicit=params.explicit),typeof params.obj<"u"&&(this.asn1Object=params.obj,this.setASN1Object(this.isExplicit,this.hT,this.asn1Object)))},YAHOO.lang.extend(KJUR.asn1.DERTaggedObject,KJUR.asn1.ASN1Object);var __extends=function(){var extendStatics=function(d,b){return extendStatics=function(d2,b2){for(var p in b2)Object.prototype.hasOwnProperty.call(b2,p)&&(d2[p]=b2[p])},extendStatics(d,b)};return function(d,b){if(typeof b!="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}(),JSEncryptRSAKey=function(_super){__extends(JSEncryptRSAKey2,_super);function JSEncryptRSAKey2(key){var _this=_super.call(this)||this;return key&&(typeof key=="string"?_this.parseKey(key):(JSEncryptRSAKey2.hasPrivateKeyProperty(key)||JSEncryptRSAKey2.hasPublicKeyProperty(key))&&_this.parsePropertiesFrom(key)),_this}return JSEncryptRSAKey2.prototype.parseKey=function(pem){try{var modulus=0,public_exponent=0,reHex=/^\s*(?:[0-9A-Fa-f][0-9A-Fa-f]\s*)+$/,der=reHex.test(pem)?Hex.decode(pem):Base64.unarmor(pem),asn1=ASN1.decode(der);if(asn1.sub.length===3&&(asn1=asn1.sub[2].sub[0]),asn1.sub.length===9){modulus=asn1.sub[1].getHexStringValue(),this.n=parseBigInt(modulus,16),public_exponent=asn1.sub[2].getHexStringValue(),this.e=parseInt(public_exponent,16);var private_exponent=asn1.sub[3].getHexStringValue();this.d=parseBigInt(private_exponent,16);var prime1=asn1.sub[4].getHexStringValue();this.p=parseBigInt(prime1,16);var prime2=asn1.sub[5].getHexStringValue();this.q=parseBigInt(prime2,16);var exponent1=asn1.sub[6].getHexStringValue();this.dmp1=parseBigInt(exponent1,16);var exponent2=asn1.sub[7].getHexStringValue();this.dmq1=parseBigInt(exponent2,16);var coefficient=asn1.sub[8].getHexStringValue();this.coeff=parseBigInt(coefficient,16)}else if(asn1.sub.length===2)if(asn1.sub[0].sub){var bit_string=asn1.sub[1],sequence=bit_string.sub[0];modulus=sequence.sub[0].getHexStringValue(),this.n=parseBigInt(modulus,16),public_exponent=sequence.sub[1].getHexStringValue(),this.e=parseInt(public_exponent,16)}else modulus=asn1.sub[0].getHexStringValue(),this.n=parseBigInt(modulus,16),public_exponent=asn1.sub[1].getHexStringValue(),this.e=parseInt(public_exponent,16);else return!1;return!0}catch{return!1}},JSEncryptRSAKey2.prototype.getPrivateBaseKey=function(){var options={array:[new KJUR.asn1.DERInteger({int:0}),new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e}),new KJUR.asn1.DERInteger({bigint:this.d}),new KJUR.asn1.DERInteger({bigint:this.p}),new KJUR.asn1.DERInteger({bigint:this.q}),new KJUR.asn1.DERInteger({bigint:this.dmp1}),new KJUR.asn1.DERInteger({bigint:this.dmq1}),new KJUR.asn1.DERInteger({bigint:this.coeff})]},seq=new KJUR.asn1.DERSequence(options);return seq.getEncodedHex()},JSEncryptRSAKey2.prototype.getPrivateBaseKeyB64=function(){return hex2b64(this.getPrivateBaseKey())},JSEncryptRSAKey2.prototype.getPublicBaseKey=function(){var first_sequence=new KJUR.asn1.DERSequence({array:[new KJUR.asn1.DERObjectIdentifier({oid:"1.2.840.113549.1.1.1"}),new KJUR.asn1.DERNull]}),second_sequence=new KJUR.asn1.DERSequence({array:[new KJUR.asn1.DERInteger({bigint:this.n}),new KJUR.asn1.DERInteger({int:this.e})]}),bit_string=new KJUR.asn1.DERBitString({hex:"00"+second_sequence.getEncodedHex()}),seq=new KJUR.asn1.DERSequence({array:[first_sequence,bit_string]});return seq.getEncodedHex()},JSEncryptRSAKey2.prototype.getPublicBaseKeyB64=function(){return hex2b64(this.getPublicBaseKey())},JSEncryptRSAKey2.wordwrap=function(str,width){if(width=width||64,!str)return str;var regex="(.{1,"+width+`})( +|$
?)|(.{1,`+width+"})";return str.match(RegExp(regex,"g")).join(`
`)},JSEncryptRSAKey2.prototype.getPrivateKey=function(){var key=`-----BEGIN RSA PRIVATE KEY-----
`;return key+=JSEncryptRSAKey2.wordwrap(this.getPrivateBaseKeyB64())+`
`,key+="-----END RSA PRIVATE KEY-----",key},JSEncryptRSAKey2.prototype.getPublicKey=function(){var key=`-----BEGIN PUBLIC KEY-----
`;return key+=JSEncryptRSAKey2.wordwrap(this.getPublicBaseKeyB64())+`
`,key+="-----END PUBLIC KEY-----",key},JSEncryptRSAKey2.hasPublicKeyProperty=function(obj){return obj=obj||{},obj.hasOwnProperty("n")&&obj.hasOwnProperty("e")},JSEncryptRSAKey2.hasPrivateKeyProperty=function(obj){return obj=obj||{},obj.hasOwnProperty("n")&&obj.hasOwnProperty("e")&&obj.hasOwnProperty("d")&&obj.hasOwnProperty("p")&&obj.hasOwnProperty("q")&&obj.hasOwnProperty("dmp1")&&obj.hasOwnProperty("dmq1")&&obj.hasOwnProperty("coeff")},JSEncryptRSAKey2.prototype.parsePropertiesFrom=function(obj){this.n=obj.n,this.e=obj.e,obj.hasOwnProperty("d")&&(this.d=obj.d,this.p=obj.p,this.q=obj.q,this.dmp1=obj.dmp1,this.dmq1=obj.dmq1,this.coeff=obj.coeff)},JSEncryptRSAKey2}(RSAKey),JSEncrypt=function(){function JSEncrypt2(options){options===void 0&&(options={}),options=options||{},this.default_key_size=options.default_key_size?parseInt(options.default_key_size,10):1024,this.default_public_exponent=options.default_public_exponent||"010001",this.log=options.log||!1,this.key=null}return JSEncrypt2.prototype.setKey=function(key){this.log&&this.key&&console.warn("A key was already set, overriding existing."),this.key=new JSEncryptRSAKey(key)},JSEncrypt2.prototype.setPrivateKey=function(privkey){this.setKey(privkey)},JSEncrypt2.prototype.setPublicKey=function(pubkey){this.setKey(pubkey)},JSEncrypt2.prototype.decrypt=function(str){try{return this.getKey().decrypt(b64tohex(str))}catch{return!1}},JSEncrypt2.prototype.encrypt=function(str){try{return hex2b64(this.getKey().encrypt(str))}catch{return!1}},JSEncrypt2.prototype.sign=function(str,digestMethod,digestName){try{return hex2b64(this.getKey().sign(str,digestMethod,digestName))}catch{return!1}},JSEncrypt2.prototype.verify=function(str,signature,digestMethod){try{return this.getKey().verify(str,b64tohex(signature),digestMethod)}catch{return!1}},JSEncrypt2.prototype.getKey=function(cb){if(!this.key){if(this.key=new JSEncryptRSAKey,cb&&{}.toString.call(cb)==="[object Function]"){this.key.generateAsync(this.default_key_size,this.default_public_exponent,cb);return}this.key.generate(this.default_key_size,this.default_public_exponent)}return this.key},JSEncrypt2.prototype.getPrivateKey=function(){return this.getKey().getPrivateKey()},JSEncrypt2.prototype.getPrivateKeyB64=function(){return this.getKey().getPrivateBaseKeyB64()},JSEncrypt2.prototype.getPublicKey=function(){return this.getKey().getPublicKey()},JSEncrypt2.prototype.getPublicKeyB64=function(){return this.getKey().getPublicBaseKeyB64()},JSEncrypt2}();window.JSEncrypt=JSEncrypt;
//# sourceMappingURL=/s/files/1/1104/4168/files/jsEncrypt.js.map?v=1756910700
