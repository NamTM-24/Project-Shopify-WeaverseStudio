import{e as O}from"./shopify.js";import{B as q,g as l,S as B}from"./base-section.js";import{N as V}from"./navigation.js";import{c as x,r as S,o as W,a as k,w as H,n as I}from"./vue.esm-bundler.js";import{u as G}from"./use-viewport-size.js";import{A as c}from"./animations.js";import{S as g,i as X}from"./swiper.js";import{k as z}from"./analytics-data.js";import"./create-element-if-not-defined.js";import"./swiper-core.js";import"./cookies.js";import"./_commonjsHelpers.js";import"./validator.js";import"./device.js";const Y={breakpoints:{0:{slidesPerView:1.3},768:{slidesPerView:2}},centeredSlides:!0,loop:!0,modules:[V],roundLengths:!0,speed:400,updateOnWindowResize:!0},T="large-product-carousel",E={PRODUCT_IMAGE_CONTAINER:"[data-product-image-container]",PRODUCT_INFO_CONTAINER:"[data-product-info-container]"};class j extends q{constructor(){super(`[data-section-type="${T}"]`)}init(i){const e=i.container,d=this;if(!e){O("[Allbirds section] - Large Product Carousel - init - Container not found",{},new Error("Container not found"));return}x({name:"LargeProductCarouselSection",setup(){let m=null;const w=S(null),h=S({cardPosition:"",handle:"",imageName:"",mensUrl:"",price:"",title:"",womensUrl:""}),p=S(null),{isMobile:v}=G(),C=o=>{const{activeIndex:t,slides:n}=o||m||{};if(!n)return;const r=n[t];if(!r)return;const u=r?.firstChild?.href,s=new URL(u),a=`${r.getAttribute("data-product-mens-url")}${s.search}`,A=`${r.getAttribute("data-product-womens-url")}${s.search}`;h.value={cardPosition:r.getAttribute("data-product-card-position"),description:r.getAttribute("data-product-description"),handle:r.getAttribute("data-product-handle"),imageName:r.getAttribute("data-product-image-name"),mensUrl:a,price:r.getAttribute("data-product-price"),title:r.getAttribute("data-product-title"),womensUrl:A}},L=async o=>{const t=e.querySelectorAll(E.PRODUCT_INFO_CONTAINER);t.length>0&&await l.to(t,c.CAROUSEL_FADE_OUT),C(o),await I(),t.length>0&&await l.to(t,c.CAROUSEL_FADE_IN)},N=()=>{const o=e.querySelector(g.CONTAINER),t=e.querySelector(g.PREV_BUTTON),n=e.querySelector(g.NEXT_BUTTON),r=s=>{const{height:a,left:A,top:R,width:U}=o.getBoundingClientRect(),y=s.clientX-A,f=s.clientY-R,M=.2,b=.75,D=f<a*M,$=f>a*b,F=U/2;D||$?(t.style.opacity=0,n.style.opacity=0):y<F?(t.style.left=`${y}px`,t.style.top=`${f}px`,t.style.opacity=1,n.style.opacity=0):(n.style.left=`${y}px`,n.style.top=`${f}px`,n.style.opacity=1,t.style.opacity=0)},u=()=>{t.style.opacity=0,n.style.opacity=0};return e.addEventListener("mousemove",r),e.addEventListener("mouseleave",u),{handleMouseLeave:u,handleMouseMove:r}},P=o=>{o&&(e.removeEventListener("mousemove",o.handleMouseMove),e.removeEventListener("mouseleave",o.handleMouseLeave))},_=async o=>{w.value=o;const t=e.querySelectorAll(E.PRODUCT_IMAGE_CONTAINER),n=e.querySelectorAll(E.PRODUCT_INFO_CONTAINER);await Promise.all([t.length>0?l.to(t,c.CAROUSEL_FADE_OUT):Promise.resolve(),n.length>0?l.to(n,c.CAROUSEL_FADE_OUT):Promise.resolve()]);const r=e.querySelector(`[data-${T}-block-id="${o}"]`);if(!r)return;const u=r.querySelectorAll(g.SLIDE);m&&m.destroy();const s=e.querySelector(g.WRAPPER);s.innerHTML="",Array.from(u).forEach(A=>{s.appendChild(A.cloneNode(!0))});const a=s.querySelectorAll(E.PRODUCT_IMAGE_CONTAINER);await I(),m=X(e,Y),C(),await I(),await Promise.all([a.length>0?l.to(a,c.CAROUSEL_FADE_IN):Promise.resolve(),n.length>0?l.to(n,c.CAROUSEL_FADE_IN):Promise.resolve()]),m.on("slideChange",L)};return W(async()=>{const o=e.getAttribute("data-initial-category-id");try{o&&await _(o)}catch(t){O("[Allbirds section] - Large Product Carousel - onMounted - Error initializing carousel",{error:t},t)}v.value||(p.value=N()),d.isHomePageTemplate()&&z({sectionName:T}),C()}),k(()=>{P(p.value)}),H(v,o=>{o?(P(p.value),p.value=null):p.value=N()}),{activeCategory:w,activeProduct:h,handleCategorySwitch:_}}}).mount(e)}setupInViewAnimation(i){if(i.animation)i.animation.paused(!1),B.refresh();else{const e=this.setupAnimation(i,()=>this.setupInViewAnimationTimeline(i));e&&e.scrollTrigger&&(i.scrollTrigger=e.scrollTrigger)}}setupInViewAnimationTimeline(i){const e=i.container;if(!e)return O("[Allbirds section] - Large Product Carousel - setupInViewAnimationTimeline - Missing elements for in-view animation",{},new Error("Missing elements for in-view animation")),null;const d=l.timeline({paused:!0,scrollTrigger:{...this.getInViewAnimationOptions(),trigger:e}});return d?(d.to(e,c.FADE_IN,0),d):null}}document.addEventListener("DOMContentLoaded",()=>{new j});
//# sourceMappingURL=large-product-carousel.js.map
